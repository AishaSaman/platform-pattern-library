<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie10 lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie10 lt-ie9"> <![endif]-->
<!--[if IE 9]>         <html class="no-js lt-ie10"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

@@include('../partials/_pl-head.html')

<body class="has-dynamic-header tour-focused">

    <div class="tour-mask"></div>

    <div id="tour-step-1" class="tour-message">
        <strong class="tour-tagline">Howdy</strong>
        <h2 class="tour-heading">And welcome to your new Ushahidi deployment.</h2>
        <p class="tour-body">While we polish up your deployment, let's take a few seconds to find a few of its most useful new tools.</p>
        <div class="tour-actions">
            <button data-cue="tour-step-2" class="button">Continue</button>
            <a data-cue="tour-step-5" class="cta">Skip</a>
        </div>
    </div>

    <div id="tour-step-2" class="tour-message">
        <h2 class="tour-heading">Collect Data</h2>
        <!--img src="http://ushahidi.com/uploads/feature-images/feature-1.svg" class="tour-image" /-->
        <p class="tour-body">Gather submissions from many sources, starting with your deployment's <em>"Add post"</em> button, or from SMS, email, and Twitter. You can collect multiple data types, as well, using custom <em>"Post Types."</em></p>
        <div class="tour-actions">
            <a data-cue="tour-step-1" class="cta">&lsaquo; Back</a>
            <button data-cue="tour-step-3" class="button">Continue</button>
            <a data-cue="tour-step-5" class="cta">Skip</a>
        </div>
    </div>

    <div id="tour-step-3" class="tour-message">
        <h2 class="tour-heading">Data Visualization</h2>
        <p class="tour-body">Every data set can be viewed in a Map, List, Bar Chart, or Timeline. Just select the view you want at any time.</p>
        <div class="tour-actions">
            <a data-cue="tour-step-2" class="cta">&lsaquo; Back</a>
            <button data-cue="tour-step-4" class="button">Continue</button>
            <a data-cue="tour-step-5" class="cta">Skip</a>
        </div>
    </div>

    <div id="tour-step-4" class="tour-message">
        <h2 class="tour-heading">Filter, Search, and Save</h2>
        <p class="tour-body">Drill into the data you need using power filters. Once you have the data you need, create a <em>Saved Search</em> so you can easily return to or share it. Your Saved Searches are always available from your deployment's main menu.</p>

        <div class="tour-actions">
            <a data-cue="tour-step-3" class="cta">&lsaquo; Back</a>
            <button data-cue="tour-step-5" class="button">Continue</button>
            <a data-cue="tour-step-5" class="cta">Skip</a>
        </div>
    </div>

    <div id="tour-step-5" class="tour-message">
        <strong class="tour-tagline">Choose a plan</strong>

        <div class="tiers">
            <div class="tier">
                <div class="tier-header">
                    <h2 class="tier-name">Standard</h2>
                    <p>For small teams that need to <br />reach more people</p>

                    <strong class="tier-price">$100 <em>a month</em></strong>

                    <h3 class="tier-feature">500 posts <em>+$10/month per 1,000 extra</em></h3>
                </div>

                <div class="tier-action">
                    <button class="modal-trigger">Choose Standard</button>
                </div>

                <div class="tier-feature-list">
                    <ul>
                        <li>Collect posts via SMS and Twitter</li>
                        <li>Turn on notifications related to your interests</li>
                        <li>View data in bar chart or trend graph</li>
                        <li>Choose from more than 10 base maps</li>
                    </ul>
                </div>

                <p><a href="" class="cta tour-link">View all features</a></p>
            </div>

            <div class="tier recommended">
                <div class="tier-header">
                    <h2 class="tier-name">Plus</h2>
                    <p>For growing teams that need <br />to organize their workflow</p>

                    <strong class="tier-price">$500 <em>a month</em></strong>

                    <h3 class="tier-feature">5,000 posts <em>+$8/month per 1,000 extra</em></h3>
                </div>

                <div class="tier-action">
                    <button class="modal-trigger">Choose Plus</button>
                </div>

                <div class="tier-feature-list">
                    <em>&#8592; Everything from Standard, and:</em>
                    <ul>
                        <li>Team collaboration with user roles</li>
                        <li>Publish posts to specific audiences</li>
                        <li>Unlimited post types</li>
                        <li>Break moderation into assignable 'steps'</li>
                    </ul>
                </div>

                <p><a href="" class="cta tour-link">View all features</a></p>
            </div>

            <div class="tier">
                <div class="tier-header">
                    <h2 class="tier-name">Enterprise</h2>
                    <p>For big, sensitive data <br />with extra security.</p>

                    <strong class="tier-price">$2,000 <em>a month</em></strong>

                    <h3 class="tier-feature">10,000 posts <em>+$4/month per 1,000 extra</em></h3>
                </div>

                <div class="tier-action">
                    <button type="button" disabled>Coming soon</button>
                </div>

                <div class="tier-feature-list">
                    <em>&#8592; Everything from Standard and Plus</em>
                </div>

                <p><a href="" class="cta tour-link">View all features</a></p>
            </div>
        </div>
    </div>

    <div class="tour-pin"><span class="pulse"></span></div>

    <header class="header header-compact overlay" role="banner">
        <div class="container">
            <div class="hero-image">
                <img src="http://github.ushahidi.org/dotcom-pattern-library/assets/img/map-bg.png" alt="" />
            </div>

            <div class="color-overlay">
                <div class="parallax">
                    <div class="nav-icon nav-icon-js">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <h1 class="beta">March on City Hall</h1>
                    <p class="header-description">Reports and communication about the protest march Wednesday, Aug. 19 to City Hall.</p>
                    <a data-message="tour-step-2" class="button button-create icon-only" href="choose-post-type.html">
                        <span>Add Post</span>
                    </a>

                    @@include('../partials/_user-admin.html')

                </div>
            </div>

        </div>
    </header>

    <div class="wrapper">

        @@include('../partials/_main-menu-loggedout.html')

        <main class="page-content has-aside" role="main">

            <h1>All Posts</h1>

            <div class="tabs-with-filter">
                <nav class="tabs-menu" data-message="tour-step-3">
                    <label class="delta-alt">View </label>
                    <button type="button" class="button-toggle tabs-menu-button-js"></button>
                    <ul class="tabs-menu-list">
                        <li class="active view-map"><a>Map</a></li>
                        <li class="view-list"><a>List</a></li>
                        <li class="view-chart"><a>Bar Chart</a></li>
                        <li class="view-timeline"><a>Timeline</a></li>
                    </ul>
                </nav>
            </div><!--end view with filter-->

            <aside data-message="tour-step-4" class="is-right" role="complementary">
                <div class="filters">
                    <div class="filters-show-hide">
                        <label class="delta-alt">Search <span>&amp; Filter</span></label>
                        <button type="button" class="button-toggle filter-button-js"></button>
                    </div>

                    @@include('../partials/_filters-inner.html')
                </div>

            </aside>

            <div class="main-col">

                <div id="map" class="map"></div>

            </div> <!--end main column-->

        </main> <!--end layout a-->

    </div>

    <footer role="contentinfo">
        <div class="wrapper">
            <div class="footer-container">
                <div class="footer-main-col">
                    <h2>March on City Hall</h2>
                    <p>Reports and communication about the protest march Wednesday, Aug. 19 to City Hall.</p>
                    <ul class="footer-nav">
                        <li><a href="">Home</a></li>
                        <li><a href="">About</a></li>
                        <li><a href="">Activity</a></li>
                        <li><a href="">Settings</a></li>
                        <li><a href="">Help</a></li>
                    </ul>
                </div>
                <div class="footer-secondary-col">
                    <a class="button button-create">
                        <span>Add Post</span>
                    </a>
                </div>
            </div>
        </div>
    </footer>


@@include('../partials/_scripts.html')

<script>
// Make header dynamic
headerMakeDynamic();

tourPin = function(element, position) {
    var targetPos = $(element).offset(),
        message = $(element).attr('data-message'),
        targetWidth = $(element).outerWidth(),
        targetHeight = $(element).outerHeight();

    if (typeof position === 'undefined') {
        $('.tour-pin').css({
            'top' : '-100%',
            'left' : '50%'
        });
    } else if (position === 'top-left') {
        $('.tour-pin').css({
            'top' : targetPos.top - 10,
            'left' : targetPos.left - 10
        });
    } else if (position === 'top-right') {
        $('.tour-pin').css({
            'top' : targetPos.top,
            'left' : targetPos.left + targetWidth - 10
        });
    } else if (position === 'bottom-left') {
        $('.tour-pin').css({
            'top' : targetPos.top + targetHeight - 10,
            'left' : targetPos.left
        });
    } else if (position === 'bottom-right') {
        $('.tour-pin').css({
            'top' : targetPos.top + targetHeight - 10,
            'left' : targetPos.left + targetWidth - 10
        });
    } else if (position === 'center') {
        $('.tour-pin').css({
            'top' : targetPos.top + targetHeight/2 - 10,
            'left' : targetPos.left + targetWidth/2 - 10
        });
    } else if (position === 'top-center') {
        $('.tour-pin').css({
            'top' : targetPos.top,
            'left' : targetPos.left + targetWidth/2 - 10
        });
    } else if (position === 'bottom-center') {
        $('.tour-pin').css({
            'top' : targetPos.top + targetHeight - 10,
            'left' : targetPos.left + targetWidth/2 - 10
        });
    }

    if (typeof element !== 'undefined') {
        // Position message
        $('#'+message).css({
            'top' : targetPos.top + targetHeight + 40
        });

        if ($(window).width() > 767) {
            if ((targetPos.left + targetWidth/2) > $(window).width()/2) {
                $('#'+message).css({
                    'left' : '65%'
                });
            } else if ((targetPos.left + targetWidth/2) < $(window).width()/2) {
                $('#'+message).css({
                    'left' : '35%'
                });
            } else {
                $('#'+message).css({
                    'left' : '50%'
                    //'left' : targetPos.left + targetWidth/2 - 3
                });
            }
        }

//        console.log(targetPos.top + targetHeight, $(window).height()/2)

        if ((targetPos.top + targetHeight) > ($(window).height()/1.5)) {
            $('html, body').animate({
                scrollTop: targetPos.top - 70
            }, 1000);
        }
    } else {
        $('html, body').animate({
            scrollTop: 0
        }, 1000);
    }
}

tourStep = function(step) {
    // Change body class to indicate new step
    $('body').removeClass(function (index, css) {
        return (css.match (/(^|\s)tour-step-\S+/g) || []).join(' ');
    }).addClass(step);

    if (step == 'tour-step-1') {
        $('.tour-mask').fadeIn(500);
        tourPin(); // Position pin and message
    } else if (step == 'tour-step-4') {
        $('.tour-mask').fadeOut(500); // Fade out mask
        tourPin('[data-message="'+step+'"]', 'bottom-center'); // Position pin and message
    } else if (step == 'tour-step-5') {
        $('.tour-mask').fadeIn(500);
        tourPin(); // Position pin and message
    } else {
        $('.tour-mask').fadeOut(500); // Fade out mask
        tourPin('[data-message="'+step+'"]', 'bottom-center'); // Position pin and message
    }
}

$(document).ready(function(){
    function lookupStep() {
        if (window.location.hash) {
            return window.location.hash.substr(1);
        } else {
            return 'tour-step-1';
        }
    }

    var step = lookupStep();

    // Disable all other links and buttons on the deployment
    $('*').not('[data-cue], .tour-link').on('click', function(e){
        e.preventDefault();
    }).off('click');

    // Click event for cue buttons
    $('[data-cue]').on('click', function() {
        var nextStep = $(this).attr('data-cue');

        tourStep(nextStep);

        if (history.pushState) {
            history.pushState(null, null, '#'+nextStep);
        } else {
            window.location.hash = nextStep;
        }
    });

    // Animate in the appropriate step
    setTimeout(function(){
        tourStep(step);
    }, 1000);

    // Go to correct step on 'Back' button
    window.onpopstate = function(event) {
        tourStep(lookupStep());
    };
});

</script>
</body>

</html>
