<div class="mode-context">
    <header class="mode-context-header">
        <a href="timeline.html" class="mode-context-back button button-link">
            <svg class="iconic">
                <use xlink:href="../../img/material/svg-sprite-navigation-symbol.svg#ic_arrow_back_24px"></use>
            </svg>
            <span class="hidden">Back</span>
        </a>

        <h1 class="mode-context-title">Edit response</h1>

        <!--// SAVED //-->
        <span class="status-indicator tooltip success">
            <svg class="iconic">
                <use xlink:href="../../img/iconic-sprite.svg#check"></use>
            </svg>
            <span class="label">Changes saved</span>
            <span class="bug">Every change you make is automatically saved. Last saved 2 minutes ago. <button class="button-link">Save now</button></span>
        </span>

        <!--// SAVING //
        <span class="status-indicator">
            <span class="label">Saving...</span>
        </span>
        //-->

        <!--// UNSAVED //
        <span class="status-indicator tooltip error" data-message="failed-save">
            <svg class="iconic">
                <use xlink:href="../../img/iconic-sprite.svg#warning"></use>
            </svg>
            <span class="label">Unsaved changes</span>
            <span class="bug">We can't auto-save your changes right now. Last saved 2 minutes ago. <button class="button-link">Try again</button></span>
        </span>
        //-->
    </header>
</div>

<!--// Uses numeric hash to determine which response to render by its index; falls back to index 0 //-->
{{#postFromHash}}
<main role="main">

    <div class="main-col">

        <div class="toolbox">
            <div class="tool">
                <div class="listing">
                    <h3 class="listing-heading">
                        <svg class="iconic">
                                <use xlink:href="../../img/iconic-sprite.svg#task"></use>
                            </svg>
                        Tasks
                    </h3>

                    <div class="listing-item checked">
                        <div class="listing-item-primary">
                            <h4 class="listing-item-title"><a href="#field-0">Categories</a></h4>
                        </div>
                    </div>

                    <div class="listing-item">
                        <div class="listing-item-primary">
                            <h4 class="listing-item-title"><a href="#section-0">Report to department</a></h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <section class="form-sheet" role="article">
            {{postBand}}

            <header class="form-sheet-summary">
                {{#postSurvey}}
                <h1 class="form-sheet-title survey-title">{{name}}</h1>
                <p>{{description}}</p>
                {{/postSurvey}}
            </header>

            <ul class="metadata">
                <li>
                    {{#ifCond properties.status 'published'}}
                    <a class="chip" data-toggle="post-status">
                        <span class="chip-icon">
                            <span class="label">Status</span>
                        </span>
                        <svg class="iconic">
                          <use xlink:href="../../img/iconic-sprite.svg#globe"></use>
                        </svg>
                        <span class="label">Published</span>
                    </a>
                    {{/ifCond}}
                    {{#ifCond properties.status 'review'}}
                    <a class="chip yellow" disabled>
                        <span class="chip-icon">
                            <span class="label">Status</span>
                        </span>
                        <svg class="iconic">
                          <use xlink:href="../../img/iconic-sprite.svg#lock-locked"></use>
                        </svg>
                        <span class="label">Under review</span>
                    </a>
                    {{/ifCond}}
                    {{#ifCond properties.status 'archived'}}
                    <a class="chip" data-toggle="post-status">
                        <span class="chip-icon">
                            <span class="label">Status</span>
                        </span>
                        <svg class="iconic">
                          <use xlink:href="../../img/iconic-sprite.svg#box"></use>
                        </svg>
                        <span class="label">Archived</span>
                    </a>
                    {{/ifCond}}
                </li>

                <li>
                    <a href="" class="chip" data-modal="edit-author">
                        <span class="chip-icon">
                            <span class="label">Author</span>
                        </span>
                        {{#if properties.author.avatar}}
                        <img src="{{properties.author.avatar}}" class="avatar" />
                        {{/if}}
                        <span class="label">{{properties.author.name}}</span>
                    </a>
                </li>

                <li>
                    <a href="" class="chip" data-modal="post-date">
                        <span class="chip-icon">
                            <svg class="iconic">
                              <use xlink:href="../../img/iconic-sprite.svg#calendar"></use>
                            </svg>
                            <span class="label">Date</span>
                        </span>
                        <span class="label">{{properties.date.post}}</span>
                    </a>
                </li>
            </ul>

            {{#each answers}}
                {{formField ../properties.survey 0 @index value}}
            {{/each}}

            <fieldset draggable="auto">
                <legend>Categories</legend>

                <div class="form-field checkbox">
                    <label for="cat1"><input type="checkbox" id="cat1" checked>Surface issues</label>
                </div>
                <div class="form-field checkbox">
                    <label for="cat2"><input type="checkbox" id="cat2">Signage</label>
                </div>
                <div class="form-field checkbox">
                    <label for="cat3"><input type="checkbox" id="cat3">Obstructions</label>
                </div>
                <!--div class="form-field checkbox" data-toggle-target="new-label">
                    <label for="cat4"><input type="checkbox" id="cat4" checked>Emergency</label>
                </div-->
                <div class="form-field inline" data-toggle-target="add-label">
                    <label class="hidden">Label name</label>
                    <input type="text" placeholder="Label name..." style="width: 240px;" />
                    <button class="button-alpha button-flat" disabled>
                        <svg class="iconic">
                            <use xlink:href="../../img/iconic-sprite.svg#check"></use>
                        </svg>
                        <span class="hidden">Add</span>
                    </button>
                    <button class="button-beta button-flat">
                        <svg class="iconic">
                            <use xlink:href="../../img/iconic-sprite.svg#trash"></use>
                        </svg>
                        <span class="hidden">Delete</span>
                    </button>
                </div>
                <div class="form-field">
                    <a data-toggle="add-label">+ Add new category</a>
                </div>

                <div class="toolbox">
                    <div class="tool">
                        <div class="tool-actions">
                            <button class="button-link" data-toggle="dropdown-menu">
                                <svg class="iconic">
                                    <use xlink:href="../../img/material/svg-sprite-navigation-symbol.svg#ic_more_vert_24px"></use>
                                </svg>
                                <span class="hidden">More</span>
                            </button>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="">
                                        <svg class="iconic">
                                            <use xlink:href="../../img/iconic-sprite.svg#person"></use>
                                        </svg>
                                        <span class="label">Change assignee</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="">
                                        <svg class="iconic">
                                            <use xlink:href="../../img/iconic-sprite.svg#circle-x"></use>
                                        </svg>
                                        <span class="label">Remove task</span>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        <div class="form-field checkbox task">
                            <label for="task-field-x"><strong>Complete this field</strong></label>
                            <input type="checkbox" checked id="task-field-x" />
                            <p class="metadata">Completed by <br/ ><img src="https://www.ushahidi.com/uploads/team-members/_teamImage/hazel.jpg" class="avatar" /> <strong class="label">Hazel Mugo</strong></p>
                        </div>
                    </div>
                </div>
            </fieldset>
        </section>

        {{#ifPostIsDataSource}}
        <div class="toolbox">
            <div class="tool">
                <fieldset>
                    <legend>Convert this into a survey response to...</legend>

                    {{#global}}
                        {{#each deployment.surveys}}
                            {{#unless datasource}}
                            <div class="form-field radio">
                                <input type="radio" name="add-to-survey" id="survey-{{@index}}" />
                                <label for="survey-{{@index}}">{{name}}</label>
                            </div>
                            {{/unless}}
                        {{/each}}
                    {{/global}}
                </fieldset>

                <div class="form-field">
                    <button class="button-flat" disabled>Convert &amp; edit</button>
                </div>
            </div>
        </div>
        {{/ifPostIsDataSource}}

        <section class="form-sheet" draggable="auto">
            {{postBand}}

            <header class="form-sheet-summary">
                <h1 class="form-sheet-title section-title">Report to department</h1>

                <div class="toolbox">
                    <div class="tool">
                        <div class="tool-actions">
                            <button class="button-link" data-toggle="dropdown-menu">
                                <svg class="iconic">
                                    <use xlink:href="../../img/material/svg-sprite-navigation-symbol.svg#ic_more_vert_24px"></use>
                                </svg>
                                <span class="hidden">More</span>
                            </button>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="">
                                        <svg class="iconic">
                                            <use xlink:href="../../img/iconic-sprite.svg#person"></use>
                                        </svg>
                                        <span class="label">Change assignee</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="">
                                        <svg class="iconic">
                                            <use xlink:href="../../img/iconic-sprite.svg#circle-x"></use>
                                        </svg>
                                        <span class="label">Remove task</span>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        <div class="form-field checkbox task">
                            <label for="task-section-x"><strong>Complete this section</strong></label>
                            <input type="checkbox" id="task-section-x" />
                            <p class="metadata">Assigned to <br/ ><img src="https://www.ushahidi.com/uploads/team-members/_teamImage/david-m.png" class="avatar" /> <strong class="label">David McNamara</strong></p>
                        </div>
                    </div>
                </div>
            </header>

            <div class="form-field">
                <label>Department</label>
                <div class="custom-select">
                    <select>
                        <option>City Council</option>
                        <option>Austin Department of Transportation</option>
                        <option>Austin Parks and Recreation</option>
                    </select>
                </div>
            </div>

            <div class="form-field">
                <label>Representative</label>
                <input type="text" />
            </div>

            <div class="form-field">
                <label>Case number</label>
                <input type="number" />
            </div>
        </section>
    </div>

</main>
{{/postFromHash}}

{{> Modals }}

<div id="required" class="message">
    <div class="message-image error">
        <svg class="iconic">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../img/iconic-sprite.svg#warning"></use>
        </svg>
    </div>

    <div class="message-body">
        <p><strong>Please complete the 'Time &amp; date of encounter' field</strong> before posting to this survey.</p>

        <a href="#time-date-encounter" class="button button-beta button-flat message-trigger">Edit field</a>

        <button class="button-flat message-trigger">
            Dismiss
        </button>
    </div>
</div>
